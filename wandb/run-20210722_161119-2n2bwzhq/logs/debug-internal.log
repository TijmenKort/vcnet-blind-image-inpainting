2021-07-22 16:11:20,793 INFO    MainThread:32290 [internal.py:wandb_internal():88] W&B internal server running at pid: 32290, started at: 2021-07-22 16:11:20.791911
2021-07-22 16:11:20,796 DEBUG   HandlerThread:32290 [handler.py:handle_request():124] handle_request: check_version
2021-07-22 16:11:20,797 INFO    WriterThread:32290 [datastore.py:open_for_write():80] open: /home/jlpkort/vcnet-blind-image-inpainting/wandb/run-20210722_161119-2n2bwzhq/run-2n2bwzhq.wandb
2021-07-22 16:11:20,802 DEBUG   SenderThread:32290 [sender.py:send():179] send: header
2021-07-22 16:11:20,802 DEBUG   SenderThread:32290 [sender.py:send_request():193] send_request: check_version
2021-07-22 16:11:20,876 DEBUG   SenderThread:32290 [sender.py:send():179] send: run
2021-07-22 16:11:20,893 INFO    SenderThread:32290 [sender.py:_maybe_setup_resume():413] checking resume status for tijmenk_/thesis_pytorch/2n2bwzhq
2021-07-22 16:11:21,062 INFO    SenderThread:32290 [sender.py:_maybe_setup_resume():472] configured resuming with: {'step': 5, 'history': 5, 'events': 28, 'output': 385, 'runtime': 786, 'summary': {'_timestamp': 1626959481, 'recon_loss': 0.3787080645561218, 'fake_global_validity': 330.81219482421875, 'adv_patch_loss': -254.17105102539065, 'tex_const_loss': 62.391075134277344, 'real_global_validity': -1938.150390625, 'm_loss': 0.21523281931877136, 'adv_loss': -578.403564453125, 'gp_global': 69.40162658691406, 'real_validity': -3428.252685546875, 'fake_patch_validity': 242.6584320068359, 'real_patch_validity': -1490.102294921875, 'gp': 122.1270751953125, '_runtime': 143, 'fake_validity': 573.4706420898438, 'sem_const_loss': 0.604827880859375, '_step': 3, 'gp_fake': 52.72544860839844, 'adv_global_loss': -324.2325439453125}, 'config': {'MASK': {'desc': None, 'value': {'SIGMA': 4, 'MAX_WIDTH': 16, 'MIN_WIDTH': 8, 'MEAN_ANGLE': 1.2566370614359172, 'ANGLE_RANGE': 0.20943951023931953, 'GAUS_K_SIZE': 15, 'MAX_NUM_VERTEX': 24, 'MIN_NUM_VERTEX': 8, 'MAX_REMOVAL_RATIO': 0.5, 'MIN_REMOVAL_RATIO': 0.2, 'NUM_ITER_SMOOTHING': 3}}, 'TEST': {'desc': None, 'value': {'FONT': '/usr/share/fonts/truetype/dejavu/DejaVuSans-Bold.ttf', 'ITER': 4, 'MODE': 7, 'TEXT': 'hello world', 'IMG_ID': 52, 'WEIGHTS': None, 'ABLATION': False, 'C_IMG_ID': 38, 'FONT_SIZE': 24, 'BATCH_SIZE': 64, 'OUTPUT_DIR': './outputs', 'BRUSH_COLOR': 'RED', 'GRAFFITI_PATH': './datasets/graffiti-dataset/dataset/graffiti_sample/000001ff0013ffff.p'}}, 'MODEL': {'desc': None, 'value': {'D': {'LR': 0.001, 'NAME': '1-ChOutputDiscriminator', 'BETAS': [0.5, 0.9], 'SCHEDULER': [], 'DECAY_RATE': 0.5, 'NUM_CRITICS': 5, 'NUM_CHANNELS': 64}, 'MPN': {'LR': 0.001, 'NAME': 'MaskPredictionNetwork', 'BETAS': [0.5, 0.9], 'SCHEDULER': [], 'DECAY_RATE': 0, 'LOSS_COEFF': 2, 'NUM_CHANNELS': 64, 'NECK_CHANNELS': 128}, 'RIN': {'LR': 0.0001, 'NAME': 'RobustInpaintingNetwork', 'BETAS': [0.5, 0.9], 'EMBRACE': True, 'SCHEDULER': [], 'DECAY_RATE': 0, 'LOSS_COEFF': 1, 'NUM_CHANNELS': 32, 'NECK_CHANNELS': 128}, 'NAME': 'VCNet', 'JOINT': {'LR': 0.0002, 'NAME': 'JointNetwork', 'BETAS': [0.5, 0.9], 'SCHEDULER': [], 'DECAY_RATE': 0.5}, 'IS_TRAIN': True, 'RAINDROP_TUNE': False, 'RAINDROP_WEIGHTS': '', 'RAINDROP_LOG_INTERVAL': 20, 'RAINDROP_SAVE_INTERVAL': 200, 'RAINDROP_VISUALIZE_INTERVAL': 20}}, 'OPTIM': {'desc': None, 'value': {'GP': 10, 'MASK': 1, 'RECON': 1.4, 'TEXTURE': 0.001, 'SEMANTIC': 0.0001, 'ADVERSARIAL': 0.001}}, 'TRAIN': {'desc': None, 'value': {'TUNE': False, 'RESUME': True, 'SHUFFLE': True, 'SAVE_DIR': './weights', 'BATCH_SIZE': 4, 'START_STEP': 0, 'LOG_INTERVAL': 200, 'SAVE_INTERVAL': 10000, 'NUM_TOTAL_STEP': 302000, 'VISUALIZE_INTERVAL': 200, 'NUM_STEPS_FOR_JOINT': 20000}}, 'WANDB': {'desc': None, 'value': {'RUN': 16, 'ENTITY': 'tijmenk_', 'LOG_DIR': './logs/VCNet_FFHQ_302000step_4bs_0.0002lr_1gpu_16run', 'NUM_ROW': 0, 'PROJECT_NAME': 'thesis_pytorch'}}, 'SYSTEM': {'desc': None, 'value': {'NUM_GPU': 1, 'NUM_WORKERS': 4}}, '_wandb': {'desc': None, 'value': {'t': {'1': [1], '2': [1], '3': [5], '4': '3.8.8', '5': '0.11.0', '8': [5]}, 'framework': 'torch', 'cli_version': '0.11.0', 'is_jupyter_run': False, 'python_version': '3.8.8', 'is_kaggle_kernel': False}}, 'DATASET': {'desc': None, 'value': {'STD': [0.5, 0.5, 0.5], 'MEAN': [0.5, 0.5, 0.5], 'NAME': 'FFHQ', 'ROOT': './datasets/ffhq/images1024x1024', 'SIZE': 256, 'IMAGENET': './datasets/ImageNet/', 'CONT_ROOT': './datasets/CelebAMask-HQ', 'RAINDROP_ROOT': './datasets/raindrop/train20/train'}}}, 'resumed': True}
2021-07-22 16:11:21,271 INFO    SenderThread:32290 [dir_watcher.py:__init__():168] watching files in: /home/jlpkort/vcnet-blind-image-inpainting/wandb/run-20210722_161119-2n2bwzhq/files
2021-07-22 16:11:21,272 INFO    SenderThread:32290 [sender.py:_start_run_threads():716] run started: 2n2bwzhq with start time 1626962293
2021-07-22 16:11:21,276 DEBUG   SenderThread:32290 [sender.py:send():179] send: summary
2021-07-22 16:11:21,278 INFO    SenderThread:32290 [sender.py:_save_file():841] saving file wandb-summary.json with policy end
2021-07-22 16:11:21,280 DEBUG   HandlerThread:32290 [handler.py:handle_request():124] handle_request: run_start
2021-07-22 16:11:21,409 DEBUG   HandlerThread:32290 [handler.py:handle_request():124] handle_request: stop_status
2021-07-22 16:11:21,410 DEBUG   SenderThread:32290 [sender.py:send_request():193] send_request: stop_status
2021-07-22 16:11:22,277 INFO    Thread-8  :32290 [dir_watcher.py:_on_file_created():216] file/dir created: /home/jlpkort/vcnet-blind-image-inpainting/wandb/run-20210722_161119-2n2bwzhq/files/output.log
2021-07-22 16:11:22,277 INFO    Thread-8  :32290 [dir_watcher.py:_on_file_created():216] file/dir created: /home/jlpkort/vcnet-blind-image-inpainting/wandb/run-20210722_161119-2n2bwzhq/files/wandb-summary.json
2021-07-22 16:11:36,589 DEBUG   HandlerThread:32290 [handler.py:handle_request():124] handle_request: stop_status
2021-07-22 16:11:36,589 DEBUG   SenderThread:32290 [sender.py:send_request():193] send_request: stop_status
2021-07-22 16:11:50,251 DEBUG   SenderThread:32290 [sender.py:send():179] send: stats
2021-07-22 16:11:51,812 DEBUG   HandlerThread:32290 [handler.py:handle_request():124] handle_request: stop_status
2021-07-22 16:11:51,813 DEBUG   SenderThread:32290 [sender.py:send_request():193] send_request: stop_status
2021-07-22 16:12:07,033 DEBUG   HandlerThread:32290 [handler.py:handle_request():124] handle_request: stop_status
2021-07-22 16:12:07,035 DEBUG   SenderThread:32290 [sender.py:send_request():193] send_request: stop_status
2021-07-22 16:12:08,315 INFO    Thread-8  :32290 [dir_watcher.py:_on_file_modified():229] file/dir modified: /home/jlpkort/vcnet-blind-image-inpainting/wandb/run-20210722_161119-2n2bwzhq/files/output.log
2021-07-22 16:12:14,325 INFO    Thread-8  :32290 [dir_watcher.py:_on_file_modified():229] file/dir modified: /home/jlpkort/vcnet-blind-image-inpainting/wandb/run-20210722_161119-2n2bwzhq/files/output.log
2021-07-22 16:12:16,328 INFO    Thread-8  :32290 [dir_watcher.py:_on_file_modified():229] file/dir modified: /home/jlpkort/vcnet-blind-image-inpainting/wandb/run-20210722_161119-2n2bwzhq/files/output.log
2021-07-22 16:12:16,903 DEBUG   HandlerThread:32290 [handler.py:handle_request():124] handle_request: poll_exit
2021-07-22 16:12:16,903 DEBUG   SenderThread:32290 [sender.py:send():179] send: telemetry
2021-07-22 16:12:16,904 DEBUG   SenderThread:32290 [sender.py:send():179] send: exit
2021-07-22 16:12:16,904 INFO    SenderThread:32290 [sender.py:send_exit():287] handling exit code: 1
2021-07-22 16:12:16,906 INFO    SenderThread:32290 [sender.py:send_exit():295] send defer
2021-07-22 16:12:16,906 DEBUG   SenderThread:32290 [sender.py:send_request():193] send_request: poll_exit
2021-07-22 16:12:16,908 DEBUG   HandlerThread:32290 [handler.py:handle_request():124] handle_request: defer
2021-07-22 16:12:16,908 INFO    HandlerThread:32290 [handler.py:handle_request_defer():141] handle defer: 0
2021-07-22 16:12:16,908 DEBUG   SenderThread:32290 [sender.py:send_request():193] send_request: defer
2021-07-22 16:12:16,909 INFO    SenderThread:32290 [sender.py:send_request_defer():304] handle sender defer: 0
2021-07-22 16:12:16,909 INFO    SenderThread:32290 [sender.py:transition_state():308] send defer: 1
2021-07-22 16:12:16,910 DEBUG   HandlerThread:32290 [handler.py:handle_request():124] handle_request: defer
2021-07-22 16:12:16,910 INFO    HandlerThread:32290 [handler.py:handle_request_defer():141] handle defer: 1
2021-07-22 16:12:17,024 DEBUG   SenderThread:32290 [sender.py:send_request():193] send_request: defer
2021-07-22 16:12:17,025 INFO    SenderThread:32290 [sender.py:send_request_defer():304] handle sender defer: 1
2021-07-22 16:12:17,025 INFO    SenderThread:32290 [sender.py:transition_state():308] send defer: 2
2021-07-22 16:12:17,025 DEBUG   HandlerThread:32290 [handler.py:handle_request():124] handle_request: poll_exit
2021-07-22 16:12:17,025 DEBUG   SenderThread:32290 [sender.py:send_request():193] send_request: poll_exit
2021-07-22 16:12:17,026 DEBUG   SenderThread:32290 [sender.py:send():179] send: stats
2021-07-22 16:12:17,027 DEBUG   HandlerThread:32290 [handler.py:handle_request():124] handle_request: defer
2021-07-22 16:12:17,028 INFO    HandlerThread:32290 [handler.py:handle_request_defer():141] handle defer: 2
2021-07-22 16:12:17,028 DEBUG   SenderThread:32290 [sender.py:send_request():193] send_request: defer
2021-07-22 16:12:17,028 INFO    SenderThread:32290 [sender.py:send_request_defer():304] handle sender defer: 2
2021-07-22 16:12:17,028 INFO    SenderThread:32290 [sender.py:transition_state():308] send defer: 3
2021-07-22 16:12:17,029 DEBUG   HandlerThread:32290 [handler.py:handle_request():124] handle_request: defer
2021-07-22 16:12:17,029 INFO    HandlerThread:32290 [handler.py:handle_request_defer():141] handle defer: 3
2021-07-22 16:12:17,030 DEBUG   SenderThread:32290 [sender.py:send():179] send: summary
2021-07-22 16:12:17,033 INFO    SenderThread:32290 [sender.py:_save_file():841] saving file wandb-summary.json with policy end
2021-07-22 16:12:17,033 DEBUG   SenderThread:32290 [sender.py:send_request():193] send_request: defer
2021-07-22 16:12:17,033 INFO    SenderThread:32290 [sender.py:send_request_defer():304] handle sender defer: 3
2021-07-22 16:12:17,033 INFO    SenderThread:32290 [sender.py:transition_state():308] send defer: 4
2021-07-22 16:12:17,034 DEBUG   HandlerThread:32290 [handler.py:handle_request():124] handle_request: defer
2021-07-22 16:12:17,034 INFO    HandlerThread:32290 [handler.py:handle_request_defer():141] handle defer: 4
2021-07-22 16:12:17,034 DEBUG   SenderThread:32290 [sender.py:send_request():193] send_request: defer
2021-07-22 16:12:17,034 INFO    SenderThread:32290 [sender.py:send_request_defer():304] handle sender defer: 4
2021-07-22 16:12:17,128 DEBUG   HandlerThread:32290 [handler.py:handle_request():124] handle_request: poll_exit
2021-07-22 16:12:17,215 INFO    SenderThread:32290 [sender.py:transition_state():308] send defer: 5
2021-07-22 16:12:17,215 DEBUG   SenderThread:32290 [sender.py:send_request():193] send_request: poll_exit
2021-07-22 16:12:17,216 DEBUG   HandlerThread:32290 [handler.py:handle_request():124] handle_request: defer
2021-07-22 16:12:17,217 INFO    HandlerThread:32290 [handler.py:handle_request_defer():141] handle defer: 5
2021-07-22 16:12:17,217 DEBUG   SenderThread:32290 [sender.py:send_request():193] send_request: defer
2021-07-22 16:12:17,217 INFO    SenderThread:32290 [sender.py:send_request_defer():304] handle sender defer: 5
2021-07-22 16:12:17,217 INFO    SenderThread:32290 [dir_watcher.py:finish():282] shutting down directory watcher
2021-07-22 16:12:17,318 DEBUG   HandlerThread:32290 [handler.py:handle_request():124] handle_request: poll_exit
2021-07-22 16:12:17,329 INFO    Thread-8  :32290 [dir_watcher.py:_on_file_modified():229] file/dir modified: /home/jlpkort/vcnet-blind-image-inpainting/wandb/run-20210722_161119-2n2bwzhq/files/config.yaml
2021-07-22 16:12:17,331 INFO    SenderThread:32290 [dir_watcher.py:_on_file_modified():229] file/dir modified: /home/jlpkort/vcnet-blind-image-inpainting/wandb/run-20210722_161119-2n2bwzhq/files/output.log
2021-07-22 16:12:17,331 INFO    SenderThread:32290 [dir_watcher.py:_on_file_modified():229] file/dir modified: /home/jlpkort/vcnet-blind-image-inpainting/wandb/run-20210722_161119-2n2bwzhq/files/wandb-summary.json
2021-07-22 16:12:17,332 INFO    SenderThread:32290 [dir_watcher.py:finish():312] scan: /home/jlpkort/vcnet-blind-image-inpainting/wandb/run-20210722_161119-2n2bwzhq/files
2021-07-22 16:12:17,332 INFO    SenderThread:32290 [dir_watcher.py:finish():318] scan save: /home/jlpkort/vcnet-blind-image-inpainting/wandb/run-20210722_161119-2n2bwzhq/files/config.yaml config.yaml
2021-07-22 16:12:17,333 INFO    SenderThread:32290 [dir_watcher.py:finish():318] scan save: /home/jlpkort/vcnet-blind-image-inpainting/wandb/run-20210722_161119-2n2bwzhq/files/wandb-summary.json wandb-summary.json
2021-07-22 16:12:17,334 INFO    SenderThread:32290 [dir_watcher.py:finish():318] scan save: /home/jlpkort/vcnet-blind-image-inpainting/wandb/run-20210722_161119-2n2bwzhq/files/output.log output.log
2021-07-22 16:12:17,353 INFO    SenderThread:32290 [sender.py:transition_state():308] send defer: 6
2021-07-22 16:12:17,354 DEBUG   SenderThread:32290 [sender.py:send_request():193] send_request: poll_exit
2021-07-22 16:12:17,356 DEBUG   HandlerThread:32290 [handler.py:handle_request():124] handle_request: defer
2021-07-22 16:12:17,356 INFO    HandlerThread:32290 [handler.py:handle_request_defer():141] handle defer: 6
2021-07-22 16:12:17,365 DEBUG   SenderThread:32290 [sender.py:send_request():193] send_request: defer
2021-07-22 16:12:17,365 INFO    SenderThread:32290 [sender.py:send_request_defer():304] handle sender defer: 6
2021-07-22 16:12:17,366 INFO    SenderThread:32290 [file_pusher.py:finish():177] shutting down file pusher
2021-07-22 16:12:17,458 DEBUG   HandlerThread:32290 [handler.py:handle_request():124] handle_request: poll_exit
2021-07-22 16:12:17,458 DEBUG   SenderThread:32290 [sender.py:send_request():193] send_request: poll_exit
2021-07-22 16:12:17,561 DEBUG   HandlerThread:32290 [handler.py:handle_request():124] handle_request: poll_exit
2021-07-22 16:12:17,562 DEBUG   SenderThread:32290 [sender.py:send_request():193] send_request: poll_exit
2021-07-22 16:12:17,665 DEBUG   HandlerThread:32290 [handler.py:handle_request():124] handle_request: poll_exit
2021-07-22 16:12:17,665 DEBUG   SenderThread:32290 [sender.py:send_request():193] send_request: poll_exit
2021-07-22 16:12:17,768 DEBUG   HandlerThread:32290 [handler.py:handle_request():124] handle_request: poll_exit
2021-07-22 16:12:17,768 DEBUG   SenderThread:32290 [sender.py:send_request():193] send_request: poll_exit
2021-07-22 16:12:17,871 DEBUG   HandlerThread:32290 [handler.py:handle_request():124] handle_request: poll_exit
2021-07-22 16:12:17,873 DEBUG   SenderThread:32290 [sender.py:send_request():193] send_request: poll_exit
2021-07-22 16:12:17,876 INFO    Thread-13 :32290 [upload_job.py:push():137] Uploaded file /home/jlpkort/vcnet-blind-image-inpainting/wandb/run-20210722_161119-2n2bwzhq/files/output.log
2021-07-22 16:12:17,884 INFO    Thread-11 :32290 [upload_job.py:push():137] Uploaded file /home/jlpkort/vcnet-blind-image-inpainting/wandb/run-20210722_161119-2n2bwzhq/files/config.yaml
2021-07-22 16:12:17,891 INFO    Thread-12 :32290 [upload_job.py:push():137] Uploaded file /home/jlpkort/vcnet-blind-image-inpainting/wandb/run-20210722_161119-2n2bwzhq/files/wandb-summary.json
2021-07-22 16:12:17,977 DEBUG   HandlerThread:32290 [handler.py:handle_request():124] handle_request: poll_exit
2021-07-22 16:12:17,978 DEBUG   SenderThread:32290 [sender.py:send_request():193] send_request: poll_exit
2021-07-22 16:12:18,081 DEBUG   HandlerThread:32290 [handler.py:handle_request():124] handle_request: poll_exit
2021-07-22 16:12:18,081 DEBUG   SenderThread:32290 [sender.py:send_request():193] send_request: poll_exit
2021-07-22 16:12:18,092 INFO    Thread-7  :32290 [sender.py:transition_state():308] send defer: 7
2021-07-22 16:12:18,093 DEBUG   HandlerThread:32290 [handler.py:handle_request():124] handle_request: defer
2021-07-22 16:12:18,093 INFO    HandlerThread:32290 [handler.py:handle_request_defer():141] handle defer: 7
2021-07-22 16:12:18,093 DEBUG   SenderThread:32290 [sender.py:send_request():193] send_request: defer
2021-07-22 16:12:18,094 INFO    SenderThread:32290 [sender.py:send_request_defer():304] handle sender defer: 7
2021-07-22 16:12:18,184 DEBUG   HandlerThread:32290 [handler.py:handle_request():124] handle_request: poll_exit
2021-07-22 16:12:18,384 INFO    SenderThread:32290 [sender.py:transition_state():308] send defer: 8
2021-07-22 16:12:18,384 DEBUG   SenderThread:32290 [sender.py:send_request():193] send_request: poll_exit
2021-07-22 16:12:18,386 DEBUG   HandlerThread:32290 [handler.py:handle_request():124] handle_request: defer
2021-07-22 16:12:18,386 INFO    HandlerThread:32290 [handler.py:handle_request_defer():141] handle defer: 8
2021-07-22 16:12:18,386 DEBUG   SenderThread:32290 [sender.py:send_request():193] send_request: defer
2021-07-22 16:12:18,387 INFO    SenderThread:32290 [sender.py:send_request_defer():304] handle sender defer: 8
2021-07-22 16:12:18,387 INFO    SenderThread:32290 [sender.py:transition_state():308] send defer: 9
2021-07-22 16:12:18,388 DEBUG   SenderThread:32290 [sender.py:send():179] send: final
2021-07-22 16:12:18,389 DEBUG   HandlerThread:32290 [handler.py:handle_request():124] handle_request: defer
2021-07-22 16:12:18,389 DEBUG   SenderThread:32290 [sender.py:send():179] send: footer
2021-07-22 16:12:18,389 INFO    HandlerThread:32290 [handler.py:handle_request_defer():141] handle defer: 9
2021-07-22 16:12:18,390 DEBUG   SenderThread:32290 [sender.py:send_request():193] send_request: defer
2021-07-22 16:12:18,390 INFO    SenderThread:32290 [sender.py:send_request_defer():304] handle sender defer: 9
2021-07-22 16:12:18,487 DEBUG   HandlerThread:32290 [handler.py:handle_request():124] handle_request: poll_exit
2021-07-22 16:12:18,488 DEBUG   SenderThread:32290 [sender.py:send_request():193] send_request: poll_exit
2021-07-22 16:12:18,488 INFO    SenderThread:32290 [file_pusher.py:join():182] waiting for file pusher
2021-07-22 16:12:18,491 DEBUG   HandlerThread:32290 [handler.py:handle_request():124] handle_request: get_summary
2021-07-22 16:12:18,494 DEBUG   HandlerThread:32290 [handler.py:handle_request():124] handle_request: sampled_history
2021-07-22 16:12:18,496 DEBUG   HandlerThread:32290 [handler.py:handle_request():124] handle_request: shutdown
2021-07-22 16:12:18,496 INFO    HandlerThread:32290 [handler.py:finish():658] shutting down handler
2021-07-22 16:12:19,389 INFO    WriterThread:32290 [datastore.py:close():288] close: /home/jlpkort/vcnet-blind-image-inpainting/wandb/run-20210722_161119-2n2bwzhq/run-2n2bwzhq.wandb
2021-07-22 16:12:19,489 INFO    SenderThread:32290 [sender.py:finish():947] shutting down sender
2021-07-22 16:12:19,489 INFO    SenderThread:32290 [file_pusher.py:finish():177] shutting down file pusher
2021-07-22 16:12:19,489 INFO    SenderThread:32290 [file_pusher.py:join():182] waiting for file pusher
2021-07-22 16:12:19,494 INFO    MainThread:32290 [internal.py:handle_exit():78] Internal process exited
